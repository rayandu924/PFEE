<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Janus WebRTC Receiver</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/janus-gateway@latest/janus.js"></script>
</head>
<body>
  <h1>WebRTC Video Receiver</h1>
  <video id="remoteVideo" width="640" height="480" autoplay></video>

  <script>
    var janus = null;
    var streaming = null;
    var opaqueId = "streamingreceiver-" + Janus.randomString(12);
    var server = "http://localhost:8088/janus";  // URL of your Janus server

    Janus.init({
      debug: "all",
      callback: function() {
        janus = new Janus({
          server: server,
          success: function() {
            janus.attach({
              plugin: "janus.plugin.streaming",
              opaqueId: opaqueId,
              success: function(pluginHandle) {
                streaming = pluginHandle;

                // Request to watch the stream
                var body = { request: "watch", id: 1 };  // Stream ID is 1
                streaming.send({ message: body });

              },
              onmessage: function(msg, jsep) {
                if (jsep !== undefined && jsep !== null) {
                  streaming.createAnswer({
                    jsep: jsep,
                    media: { audioSend: false, videoSend: false },  // We only receive
                    success: function(jsep) {
                      var body = { request: "start" };
                      streaming.send({ message: body, jsep: jsep });
                    }
                  });
                }
              },
              onremotestream: function(stream) {
                $('#remoteVideo').get(0).srcObject = stream;
              }
            });
          }
        });
      }
    });
  </script>
</body>
</html>
